<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="unifir">
<title>unifir 101 - A user's guide • unifir</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="unifir 101 - A user's guide">
<meta property="og:description" content="unifir">
<meta property="og:image" content="https://docs.ropensci.org/unifir/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">unifir</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.4.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/unifir-asset-guide.html">unifir 103 - Using Assets</a>
    <a class="dropdown-item" href="../articles/unifir-dev-guide.html">unifir 102 - A developer's guide</a>
    <a class="dropdown-item" href="../articles/unifir-user-guide.html">unifir 101 - A user's guide</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/unifir/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>unifir 101 - A user's guide</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/unifir/blob/HEAD/vignettes/unifir-user-guide.Rmd" class="external-link"><code>vignettes/unifir-user-guide.Rmd</code></a></small>
      <div class="d-none name"><code>unifir-user-guide.Rmd</code></div>
    </div>

    
    
<p>This document aims to provide a quickstart guide to using unifir. By that, I mean on how an end user could use unifir to produce and create Unity scenes. For more information on how the underlying framework functions, check out <a href="unifir-dev-guide.html">unifir 102 - A developer’s guide</a>. This vignette is going to assume you want to use unifir directly to control your scenes and manage a Unity project.</p>
<p>But before we get into that, we should answer a question: why use unifir at all?</p>
<div class="section level2">
<h2 id="why-unifir">Why unifir?<a class="anchor" aria-label="anchor" href="#why-unifir"></a>
</h2>
<p><a href="https://unity.com/" class="external-link">Unity</a> is a video game engine which can be used to produce any number of immersive experiences, ranging from fantastical video game worlds to more grounded representations of real-world places. Typically, a Unity project is created and edited entirely in the Unity GUI, with the landscape and everything in it placed very intentionally by a designer.</p>
<p>That approach works really well when attempting to build artistic experiences, but limits the power of this tool as a way to represent very specific scenarios. If you have a landscape you want to represent in a game engine – be it a real world location or the outputs from a simulation program – actually creating that representation is a painstaking manual process. And that’s a shame, because the sorts of immersive virtual environments that you can make in Unity have the potential to be really powerful communication tools.</p>
<p>It’s into that world that we’re launching unifir. This package aims to connect R – one of the best tools in existence for wrangling data, be it about the real world or a simulated output – with Unity, so that creating data-driven representations can be less painful (and as a nice side effect, more reproducible and less error-prone as well). Hopefully, by providing a well-structured set of tools for interacting with the Unity scripting API, we can make it easier to produce these sorts of data-driven virtual environments moving forward.</p>
</div>
<div class="section level2">
<h2 id="how-unifir">How unifir?<a class="anchor" aria-label="anchor" href="#how-unifir"></a>
</h2>
<p>With the why answered, it’s time to move on to the how. Before we get into the R specifics, it’s probably worthwhile to define a few terms.</p>
<p>We’ll be talking a lot about Unity <em>projects</em>, which are single directories inside which all of the code and data associated with a single Unity environment are stored. unifir operates on a single project at a time; there’s not a way to have a single pipeline work across two different projects. Similarly, a given Unity GUI window only operates on a single project at a time. The next level of organization within Unity is a <em>scene</em>, which is a collection of objects and code that are present in the user’s environment at the same time. unifir can operate on multiple <em>scenes</em> within a single <em>project</em> with no problem.</p>
<p>With that sorted, we can move on to unifir itself. The first part of working with Unity from R is <a href="https://unity.com/download" class="external-link">installing Unity</a>. Once Unity is installed on your machine, you should be able to locate it using the function <code><a href="../reference/find_unity.html">find_unity()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/unifir/">unifir</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/find_unity.html">find_unity</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This function finds the path to the Unity executable on your system that unifir will use to execute all its commands. Should you want to use a different Unity version, you can set the environment variable <code>unifir_unity_path</code> (or the option of the same name) to the path to the version you want to use.</p>
<p>With your Unity location set, you should be ready to start working with unifir. The key object of the unifir package is the “script” object, which unifir uses to store all of the commands you’re going to execute in Unity before actually running them. We can use the <code><a href="../reference/make_script.html">make_script()</a></code> function to make a script, using the <code>project</code> argument to specify where on our machine we want the Unity project to exist. If the project directory doesn’t exist, it will be created automatically unless you set <code>initialize_project = FALSE</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">script</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_script.html">make_script</a></span><span class="op">(</span></span>
<span>  project <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"unifir"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Our object <code>script</code> is now an R6 object of the class <code>unifir_script</code>. By itself, this object isn’t super exciting; however, it provides the basic shell we’re going to use to keep track of all the things we want to do to our project.</p>
<p>In order to specify those things, we can go ahead and add “props” to our “script” object. unifir comes with a number of prop-building functions pre-specified, though the hope is that with time other packages can add their own props to this framework, enabling a wider variety of functionality than is currently implemented. For instance, the <a href="https://github.com/ropensci/terrainr" class="external-link">terrainr</a> package provides a function, <code>make_unity</code> (currently only in the development build) which converts any files that can be read by the <code>raster</code> package into terrain surfaces you can actually walk across. That function wraps a number of unifir props to actually interact with the Unity engine, but also performs some spatial data wrangling that make sense to live in a more specialized package.</p>
<p>As a result, the props that are actually implemented in unifir tend to be a little more elemental – creating and saving scenes, adding lights and player controllers, the sorts of things that are applicable to most Unity projects. If we wanted to add a character controller to our scene, for instance, we can use the <code><a href="../reference/add_asset.html">add_default_player()</a></code> function to modify our <code>script</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">script</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_asset.html">add_default_player</a></span><span class="op">(</span><span class="va">script</span><span class="op">)</span></span></code></pre></div>
<p>On the surface, our <code>script</code> object doesn’t change when we do this. However, if we look at <code>script$props</code> instead, we’d see that we now have three <code>unifir_prop</code> objects in our script. This list is how unifir keeps track of what exactly it needs to do to make your script into a scene; it will run through your props in the order you added them to the script. <code><a href="../reference/add_asset.html">add_default_player()</a></code> is just one function that adds props to our script; other functions in unifir will add props to add lights, 3D models, terrain, and more to your script. You can see the prop functions listed under “See Also” in any prop’s help page (so for instance, after running <code><a href="../reference/add_asset.html">?add_default_player</a></code>).</p>
<p>One thing to highlight is that we need to explicitly save our scenes at the end of any script. If you don’t save your scene, then after your script executes you’ll find that Unity hasn’t made any changes to your project! Always be sure to add a <code><a href="../reference/save_scene.html">save_scene()</a></code> call to the end of your script:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">script</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/save_scene.html">save_scene</a></span><span class="op">(</span><span class="va">script</span><span class="op">)</span></span></code></pre></div>
<p>This will save our scene with all of its changes, but Unity won’t automatically default to <em>loading</em> this scene when we open our project. If we want our scene to load as soon as we open the project, we can add another prop to our script via the function <code><a href="../reference/set_active_scene.html">set_active_scene()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">script</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_active_scene.html">set_active_scene</a></span><span class="op">(</span><span class="va">script</span><span class="op">)</span></span></code></pre></div>
<p>If you forget to do this, you can open scenes from inside Unity (File -&gt; Open Scene); unifir always saves scenes to the “Scenes” folder.</p>
<p>Now that we’ve added props to our script, it’s time to actually make our scene a reality. You can play out your script using the function <code><a href="../reference/action.html">action()</a></code>, which will create a Unity project, turn your props into C# code, and then execute that code inside the project to produce your scenes!</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/action.html">action</a></span><span class="op">(</span><span class="va">script</span><span class="op">)</span></span></code></pre></div>
<p>And just like that, you’ve created a Unity project that you can open and look around in! Note that your scene won’t be open by default (unless you’ve used the <code><a href="../reference/set_active_scene.html">set_active_scene()</a></code> function) – to actually <em>see</em> all the changes you’ve made, make sure to load the scene located in the <code>Scenes</code> folder inside your project.</p>
</div>
<div class="section level2">
<h2 id="a-full-example">A full example<a class="anchor" aria-label="anchor" href="#a-full-example"></a>
</h2>
<p>So now that we know the basics of how a unifir script is built, we should walk through how to actually build one to make a scene! We’ll walk through adding terrain, trees, and a character to a scene and then see what it looks like when rendered.</p>
<p>First things first, we’ll need a script! Just like before, we’ll make our script using the <code><a href="../reference/make_script.html">make_script()</a></code> function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_script</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_script.html">make_script</a></span><span class="op">(</span></span>
<span>  project <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"unifir"</span>, <span class="st">"random_trees"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Up next, we need data on the terrain we want to add! We can generate a random terrain surface using the terra package, so we’ll load that now:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></code></pre></div>
<p>And we’ll need to convert that terrain into a format Unity can read, so we’ll load in the terrainr package as well:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/terrainr/" class="external-link">terrainr</a></span><span class="op">)</span></span></code></pre></div>
<p>Importing terrain into Unity is a little bit wonky. First off, Unity can’t process standard raster data, but rather needs a specialized format that most libraries don’t work with (namely, raw bytestreams with planar interlacing); for that reason, we’re going to need to use terrainr’s <code><a href="https://docs.ropensci.org/terrainr/reference/unity_crops.html" class="external-link">transform_elevation()</a></code> function to transform our elevation raster into a proper format.</p>
<p>Additionally, Unity doesn’t have a great way for wrangling objects of different unit systems – it assumes that a distance of “1” in a 3D model is also a distance of “1” in the terrain, no matter what units that “1” is in. It’s common, but not at all universal, for a distance of “1” to represent a distance of 1 meter, but depending where you’re getting assets from you might need to rescale your rasters and models to make everything line up appropriately.</p>
<p>Lastly, Unity expects terrain tiles to be (2^x) + 1 unit squares, where x is some number between 1 and 12. For that reason, we’ll go ahead and generate a terrain tile that’s 4,097 units across in both directions, with heights centered on 10 units elevation. We’ll then go ahead and write that out to a temporary file at <code>raster_file</code>, then use terrainr to convert that raster into a format Unity can import:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">terrain_size</span> <span class="op">&lt;-</span> <span class="fl">4097</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">terrain_size</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="va">terrain_size</span><span class="op">)</span>,</span>
<span>  extent <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">terrain_size</span>, <span class="fl">0</span>, <span class="va">terrain_size</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">raster_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tiff"</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">raster_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># I'm quieting the warnings down here, because they can be safely ignored:</span></span>
<span><span class="va">raster_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span>
<span>  <span class="fu">terrainr</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/terrainr/reference/unity_crops.html" class="external-link">transform_elevation</a></span><span class="op">(</span><span class="va">raster_file</span>, </span>
<span>                                side_length <span class="op">=</span> <span class="va">terrain_size</span>,</span>
<span>                                output_prefix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can then go ahead and add that terrain object to our scene using the function <code><a href="../reference/create_terrain.html">create_terrain()</a></code>. This function is a bit unwieldy (and will soon have some user-friendly wrappers in the terrainr package), so I’ll explain the function arguments inline:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_script</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_terrain.html">create_terrain</a></span><span class="op">(</span></span>
<span>  script <span class="op">=</span> <span class="va">tree_script</span>, <span class="co"># Our unifir_script</span></span>
<span>  heightmap_path <span class="op">=</span> <span class="va">raster_file</span>, <span class="co"># The file path to our elevation raster</span></span>
<span>  <span class="co"># Where should the "top-left" corner of the terrain sit? </span></span>
<span>  <span class="co"># Note that Unity uses a left-handed Y-up coordinate system </span></span>
<span>  <span class="co"># where Y is the vertical axis and X and Z define the "horizontal" plane.</span></span>
<span>  <span class="co"># We want our terrain to center on the origin of the scene (that is, 0,0,0)</span></span>
<span>  <span class="co"># so we'll set both to -2,050:</span></span>
<span>  x_pos <span class="op">=</span> <span class="op">-</span><span class="fl">2050</span>,</span>
<span>  z_pos <span class="op">=</span> <span class="op">-</span><span class="fl">2050</span>,</span>
<span>  width <span class="op">=</span> <span class="va">terrain_size</span>, <span class="co"># The total width of the terrain tile (X axis)</span></span>
<span>  length <span class="op">=</span> <span class="va">terrain_size</span>, <span class="co"># The total length of the terrain tile (Z axis)</span></span>
<span>  height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/global.html" class="external-link">global</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">max</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Max height of the terrain (Y axis)</span></span>
<span>  <span class="co"># How many pixels are there in the raster along the total width/length?</span></span>
<span>  heightmap_resolution <span class="op">=</span> <span class="va">terrain_size</span> </span>
<span><span class="op">)</span></span></code></pre></div>
<p>Our terrain is now set to be added to our scene when we run our script! Up next, we can go ahead and add trees on top of the scene. We’ll randomly generate 100 X and Z coordinates (since Y is “up” in Unity), centered around the 0,0 point at the middle of our map:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_trees</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">num_trees</span>, <span class="op">-</span><span class="fl">40</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>  z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">num_trees</span>, <span class="op">-</span><span class="fl">40</span>, <span class="fl">40</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Planting trees at these positions is a lot easier than putting our terrain in place. unifir provides a function, <code><a href="../reference/add_asset.html">add_default_tree()</a></code>, which will download and add a few simple tree models to any scene you want. There’s 12 tree models available at the time of writing, all released under the public domain; we’ll use the first one named <code>tree_1</code>.</p>
<p>This function is vectorized, so can create multiple trees at once. We’ll take advantage of that by providing our X and Z coordinates to create 100 separate trees at once – note that if we wanted, we could also pass a vector of tree names to use multiple models at the same time.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_script</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_asset.html">add_default_tree</a></span><span class="op">(</span></span>
<span>  <span class="va">tree_script</span>,</span>
<span>  <span class="st">"tree_1"</span>,</span>
<span>  x_position <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">x</span>,</span>
<span>  z_position <span class="op">=</span> <span class="va">pos</span><span class="op">$</span><span class="va">z</span>,</span>
<span>  y_position <span class="op">=</span> <span class="fl">0</span> <span class="co"># The average height of the terrain</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We’ve now got instructions to create our terrain and our tree objects! We also want to add a player controller to the scene, using the <code><a href="../reference/add_asset.html">add_default_player()</a></code> function created earlier:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_script</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_asset.html">add_default_player</a></span><span class="op">(</span><span class="va">tree_script</span><span class="op">)</span></span></code></pre></div>
<p>And we should also add a light to the scene, using the <code><a href="../reference/add_light.html">add_light()</a></code> function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_script</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_light.html">add_light</a></span><span class="op">(</span><span class="va">tree_script</span><span class="op">)</span></span></code></pre></div>
<p>With all of our props in place, we now need to make sure that we save our changes! We should also set up our project so that it loads our scene as soon as its opened:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_script</span> <span class="op">&lt;-</span> <span class="va">tree_script</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/save_scene.html">save_scene</a></span><span class="op">(</span>scene_name <span class="op">=</span> <span class="st">"trees"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_active_scene.html">set_active_scene</a></span><span class="op">(</span>scene_name <span class="op">=</span> <span class="st">"trees"</span><span class="op">)</span></span></code></pre></div>
<p>And with that, we’re good to go! The only thing left to do is to run our script, using the <code><a href="../reference/action.html">action()</a></code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/action.html">action</a></span><span class="op">(</span><span class="va">tree_script</span><span class="op">)</span></span></code></pre></div>
<p>Upon opening Unity, you should see your terrain and trees fully realized in the scene:</p>
<p><img src="random_trees.png" width="858"></p>
<p>If you hit the “play” button at the top of the window, you’ll drop into the player character and can walk around and explore your environment.</p>
<p>And there’s all you need to know to start using unifir! If you’re looking to get even more in the weeds about how unifir works, make sure to check out unifir 102 - A developer’s guide.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
